import { Component, Input } from '@angular/core';
import { AlertService } from '../@core/service/alert.service';
import { LocalService } from '../@core/service/local.service';
import { selectAllGridsterItems } from '../@shared/master-view-state/master-view.selectors';
import { clearComponents, setComponents } from '../@shared/master-view-state/master-view.actions';
import { DynamicSearchCleanupComponent } from '../dynamic-searchcleanup/dynamic-searchcleanup.component';
import * as i0 from "@angular/core";
import * as i1 from "@angular/router";
import * as i2 from "../@core/service/dynamic-tab-page-service";
import * as i3 from "@ngrx/store";
import * as i4 from "@angular/common";
import * as i5 from "ng-dynamic-component";
import * as i6 from "primeng/accordion";
// import { DynamicPageModifyBypageidComponent } from '../dynamic-tab-page/dynamic-page-modify-bypageid/dynamic-page-modify-bypageid.component';
export class CompositePageComponent {
    route;
    dynamicTabPageService;
    store;
    CompositePageWidget$;
    compositePageId;
    id;
    alertService;
    storage;
    editMode = true;
    activeIndexes = [];
    constructor(injector, route, dynamicTabPageService, store) {
        this.route = route;
        this.dynamicTabPageService = dynamicTabPageService;
        this.store = store;
        this.alertService = injector.get(AlertService);
        this.storage = injector.get(LocalService);
        this.CompositePageWidget$ = this.store.select(selectAllGridsterItems);
    }
    ngOnInit() {
        this.compositePageId = this.route.snapshot.paramMap.get('compositePageId');
        this.id = this.route.snapshot.paramMap.get('id');
        if (window.location.pathname.includes('composite-page/view')) {
            this.editMode = false;
        }
        this.getDynamicPage(this.compositePageId);
    }
    ngAfterViewInit() {
        this.route.paramMap.subscribe(() => {
            this.compositePageId = this.route.snapshot.paramMap.get('compositePageId');
            this.id = this.route.snapshot.paramMap.get('id');
            this.getDynamicPage(this.compositePageId);
        });
    }
    getDynamicPage(compositePageId) {
        this.dynamicTabPageService.getDynamicPage(compositePageId).subscribe(value => {
            const activeversionid = value['data'][0].activeversionid;
            this.dynamicTabPageService.getActivePage(activeversionid, this.editMode).subscribe(resu => {
                if (resu) {
                    const compositePageconfig = typeof resu['data'].masterviewconfig === 'string'
                        ? JSON.parse(resu['data'].masterviewconfig)
                        : resu['data'].masterviewconfig;
                    if (compositePageconfig) {
                        compositePageconfig.forEach((x, index) => {
                            x.loadedFromCompositePage = true;
                            x.input = { ...x.input, componentId: x.id, id: this.id };
                            if (x.componentName === 'dynamicpage-common') {
                                x.component = DynamicSearchCleanupComponent;
                            }
                            else if (x.componentName === 'dynamicpage-sea') {
                                x.component = DynamicSearchCleanupComponent;
                            }
                            if (x?.settings?.defaultState == 'EXP') {
                                this.activeIndexes.push(index);
                            }
                        });
                        this.store.dispatch(setComponents({ components: compositePageconfig }));
                    }
                }
            });
        }, error => {
            this.alertService.error('Something went wrong');
            console.error(error);
        });
    }
    ngOnDestroy() {
        this.store.dispatch(clearComponents());
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: CompositePageComponent, deps: [{ token: i0.Injector }, { token: i1.ActivatedRoute }, { token: i2.DynamicTabPageService }, { token: i3.Store }], target: i0.ɵɵFactoryTarget.Component });
    static ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.2.12", type: CompositePageComponent, selector: "app-composite-page", inputs: { compositePageId: "compositePageId" }, ngImport: i0, template: "\r\n<div class=\"float-container\">\r\n  <div class=\"float-child-right\">\r\n    <div class=\"dashboard-inner mt-0\">\r\n      <div class=\"float-child-right\">\r\n        <ng-container *ngFor=\"let item of CompositePageWidget$ | async; let i = index\">\r\n          <div [ngSwitch]=\"item?.settings?.defaultState\">\r\n            <p-accordion [multiple]=\"true\" *ngSwitchCase=\"'EXP'\" [activeIndex]=\"[0]\">\r\n              <p-accordionTab header=\"{{item.settings?.title || item.name}}\">\r\n                <div class=\"clearfix gridster-item-group card\">\r\n                  <div class=\"gridster-item-content card-body\">\r\n                    <ndc-dynamic [ndcDynamicComponent]=\"item.component\" [ndcDynamicInputs]=\"item.input\"></ndc-dynamic>\r\n                  </div>\r\n                </div>\r\n              </p-accordionTab>\r\n            </p-accordion>\r\n    \r\n            <div *ngSwitchCase=\"'DIV'\" class=\"clearfix gridster-item-group card mt-6\">\r\n              <h6 class=\"card-header\">{{ item.settings?.title || item.name }}</h6>\r\n              <div class=\"gridster-item-content card-body\">\r\n                <ndc-dynamic [ndcDynamicComponent]=\"item.component\" [ndcDynamicInputs]=\"item.input\"></ndc-dynamic>\r\n              </div>\r\n            </div>\r\n    \r\n            <p-accordion [multiple]=\"true\" *ngSwitchDefault>\r\n              <p-accordionTab header=\"{{item.settings?.title || item.name}}\">\r\n                <div class=\"clearfix gridster-item-group card\">\r\n                  <div class=\"gridster-item-content card-body\">\r\n                    <ndc-dynamic [ndcDynamicComponent]=\"item.component\" [ndcDynamicInputs]=\"item.input\"></ndc-dynamic>\r\n                  </div>\r\n                </div>\r\n              </p-accordionTab>\r\n            </p-accordion>\r\n          </div>\r\n        </ng-container>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>", styles: [".float-container .float-child-right{max-height:calc(100vh - 280px);overflow-y:auto;overflow-x:hidden}.float-container .float-child-right .close-button{position:absolute;top:2px;right:5px;cursor:pointer;color:#007cc3}.float-container .float-child-right .overallSec{padding-left:0}.float-container .gridster{display:inline-table;background:transparent;padding:0!important}.float-container .gridster-item{margin:0 0 15px!important;padding:0 12px 12px;overflow-y:auto}.float-container .gridster-item-content{position:relative;padding:0}.pull-right{padding:5px}.gridster{height:120vh;margin:0;padding:0;background-color:#b3b1b1}.gridster-container{margin-top:10px;margin-left:10px}.top-btn-left{width:150px;margin:5px}.top-btn-right{width:350px;margin:5px}.widget-header{background-color:#eee;cursor:default}.widget-header-btn{cursor:pointer}.header-margin-left{margin-left:5px}.header-margin-right{margin-right:5px}app-nomination-widget{height:100%}.widget-header-buttons{display:flex;align-items:center;justify-content:space-between}.widget-header-buttons h6{font-size:12px;text-transform:uppercase;font-weight:600;color:#2c2863}\n"], dependencies: [{ kind: "directive", type: i4.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i4.NgSwitch, selector: "[ngSwitch]", inputs: ["ngSwitch"] }, { kind: "directive", type: i4.NgSwitchCase, selector: "[ngSwitchCase]", inputs: ["ngSwitchCase"] }, { kind: "directive", type: i4.NgSwitchDefault, selector: "[ngSwitchDefault]" }, { kind: "directive", type: i5.DynamicIoDirective, selector: "[ndcDynamicInputs],[ndcDynamicOutputs]", inputs: ["ndcDynamicInputs", "ndcDynamicOutputs"], exportAs: ["ndcDynamicIo"] }, { kind: "component", type: i5.DynamicComponent, selector: "ndc-dynamic", inputs: ["ndcDynamicComponent", "ndcDynamicInjector", "ndcDynamicProviders", "ndcDynamicContent", "ndcDynamicNgModuleRef", "ndcDynamicEnvironmentInjector"], outputs: ["ndcDynamicCreated"] }, { kind: "component", type: i6.Accordion, selector: "p-accordion", inputs: ["multiple", "style", "styleClass", "expandIcon", "collapseIcon", "activeIndex", "selectOnFocus", "headerAriaLevel"], outputs: ["onClose", "onOpen", "activeIndexChange"] }, { kind: "component", type: i6.AccordionTab, selector: "p-accordionTab", inputs: ["id", "header", "headerStyle", "tabStyle", "contentStyle", "tabStyleClass", "headerStyleClass", "contentStyleClass", "disabled", "cache", "transitionOptions", "iconPos", "selected", "headerAriaLevel"], outputs: ["selectedChange"] }, { kind: "pipe", type: i4.AsyncPipe, name: "async" }] });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: CompositePageComponent, decorators: [{
            type: Component,
            args: [{ selector: 'app-composite-page', template: "\r\n<div class=\"float-container\">\r\n  <div class=\"float-child-right\">\r\n    <div class=\"dashboard-inner mt-0\">\r\n      <div class=\"float-child-right\">\r\n        <ng-container *ngFor=\"let item of CompositePageWidget$ | async; let i = index\">\r\n          <div [ngSwitch]=\"item?.settings?.defaultState\">\r\n            <p-accordion [multiple]=\"true\" *ngSwitchCase=\"'EXP'\" [activeIndex]=\"[0]\">\r\n              <p-accordionTab header=\"{{item.settings?.title || item.name}}\">\r\n                <div class=\"clearfix gridster-item-group card\">\r\n                  <div class=\"gridster-item-content card-body\">\r\n                    <ndc-dynamic [ndcDynamicComponent]=\"item.component\" [ndcDynamicInputs]=\"item.input\"></ndc-dynamic>\r\n                  </div>\r\n                </div>\r\n              </p-accordionTab>\r\n            </p-accordion>\r\n    \r\n            <div *ngSwitchCase=\"'DIV'\" class=\"clearfix gridster-item-group card mt-6\">\r\n              <h6 class=\"card-header\">{{ item.settings?.title || item.name }}</h6>\r\n              <div class=\"gridster-item-content card-body\">\r\n                <ndc-dynamic [ndcDynamicComponent]=\"item.component\" [ndcDynamicInputs]=\"item.input\"></ndc-dynamic>\r\n              </div>\r\n            </div>\r\n    \r\n            <p-accordion [multiple]=\"true\" *ngSwitchDefault>\r\n              <p-accordionTab header=\"{{item.settings?.title || item.name}}\">\r\n                <div class=\"clearfix gridster-item-group card\">\r\n                  <div class=\"gridster-item-content card-body\">\r\n                    <ndc-dynamic [ndcDynamicComponent]=\"item.component\" [ndcDynamicInputs]=\"item.input\"></ndc-dynamic>\r\n                  </div>\r\n                </div>\r\n              </p-accordionTab>\r\n            </p-accordion>\r\n          </div>\r\n        </ng-container>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>", styles: [".float-container .float-child-right{max-height:calc(100vh - 280px);overflow-y:auto;overflow-x:hidden}.float-container .float-child-right .close-button{position:absolute;top:2px;right:5px;cursor:pointer;color:#007cc3}.float-container .float-child-right .overallSec{padding-left:0}.float-container .gridster{display:inline-table;background:transparent;padding:0!important}.float-container .gridster-item{margin:0 0 15px!important;padding:0 12px 12px;overflow-y:auto}.float-container .gridster-item-content{position:relative;padding:0}.pull-right{padding:5px}.gridster{height:120vh;margin:0;padding:0;background-color:#b3b1b1}.gridster-container{margin-top:10px;margin-left:10px}.top-btn-left{width:150px;margin:5px}.top-btn-right{width:350px;margin:5px}.widget-header{background-color:#eee;cursor:default}.widget-header-btn{cursor:pointer}.header-margin-left{margin-left:5px}.header-margin-right{margin-right:5px}app-nomination-widget{height:100%}.widget-header-buttons{display:flex;align-items:center;justify-content:space-between}.widget-header-buttons h6{font-size:12px;text-transform:uppercase;font-weight:600;color:#2c2863}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.Injector }, { type: i1.ActivatedRoute }, { type: i2.DynamicTabPageService }, { type: i3.Store }]; }, propDecorators: { compositePageId: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9zaXRlLXBhZ2UuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvcGljcy1jb3JlL2R5bmFtaWMvc3JjL2xpYi9waWNzLWR5bmFtaWMvY29tcG9zaXRlLXBhZ2UvY29tcG9zaXRlLXBhZ2UuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvcGljcy1jb3JlL2R5bmFtaWMvc3JjL2xpYi9waWNzLWR5bmFtaWMvY29tcG9zaXRlLXBhZ2UvY29tcG9zaXRlLXBhZ2UuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBWSxLQUFLLEVBQXFCLE1BQU0sZUFBZSxDQUFDO0FBTTlFLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUM5RCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFFOUQsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sb0RBQW9ELENBQUM7QUFDNUYsT0FBTyxFQUFFLGVBQWUsRUFBRSxhQUFhLEVBQUUsTUFBTSxrREFBa0QsQ0FBQztBQUVsRyxPQUFPLEVBQUUsNkJBQTZCLEVBQUUsTUFBTSwwREFBMEQsQ0FBQzs7Ozs7Ozs7QUFDekcsZ0pBQWdKO0FBT2hKLE1BQU0sT0FBTyxzQkFBc0I7SUFXdkI7SUFDQTtJQUNBO0lBWlYsb0JBQW9CLENBQStCO0lBQzFDLGVBQWUsQ0FBQztJQUN6QixFQUFFLENBQU87SUFDVCxZQUFZLENBQWU7SUFDM0IsT0FBTyxDQUFlO0lBQ3RCLFFBQVEsR0FBWSxJQUFJLENBQUM7SUFDekIsYUFBYSxHQUFhLEVBQUUsQ0FBQztJQUU3QixZQUNFLFFBQWtCLEVBQ1YsS0FBcUIsRUFDckIscUJBQTRDLEVBQzVDLEtBQXNCO1FBRnRCLFVBQUssR0FBTCxLQUFLLENBQWdCO1FBQ3JCLDBCQUFxQixHQUFy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QWlCLEVBQUU7Z0NBQ2hELENBQUMsQ0FBQyxTQUFTLEdBQUcsNkJBQTZCLENBQUM7NkJBQzdDOzRCQUVELElBQUksQ0FBQyxFQUFFLFFBQVEsRUFBRSxZQUFZLElBQUksS0FBSyxFQUFFO2dDQUN0QyxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQzs2QkFDaEM7d0JBQ0gsQ0FBQyxDQUFDLENBQUM7d0JBQ0gsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLEVBQUUsVUFBVSxFQUFFLG1CQUFtQixFQUFFLENBQUMsQ0FBQyxDQUFDO3FCQUN6RTtpQkFDRjtZQUNILENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxFQUNELEtBQUssQ0FBQyxFQUFFO1lBQ04sSUFBSSxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsc0JBQXNCLENBQUMsQ0FBQztZQUNoRCxPQUFPLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELFdBQVc7UUFDVCxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxlQUFlLEVBQUUsQ0FBQyxDQUFDO0lBQ3pDLENBQUM7d0dBM0VVLHNCQUFzQjs0RkFBdEIsc0JBQXNCLDBHQ3BCbkMsczVEQXNDTTs7NEZEbEJPLHNCQUFzQjtrQkFMbEMsU0FBUzsrQkFDRSxvQkFBb0I7b0xBTXJCLGVBQWU7c0JBQXZCLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEluamVjdG9yLCBJbnB1dCwgT25Jbml0LCBPbkRlc3Ryb3kgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQWN0aXZhdGVkUm91dGUgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xyXG5pbXBvcnQgeyBEeW5hbWljVGFiUGFnZVNlcnZpY2UgfSBmcm9tICcuLi9AY29yZS9zZXJ2aWNlL2R5bmFtaWMtdGFiLXBhZ2Utc2VydmljZSc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgU3RvcmUgfSBmcm9tICdAbmdyeC9zdG9yZSc7XHJcbmltcG9ydCB7IEFwcFN0YXRlIH0gZnJvbSAnLi4vQGNvcmUvY29yZS5zdGF0ZSc7XHJcbmltcG9ydCB7IEFsZXJ0U2VydmljZSB9IGZyb20gJy4uL0Bjb3JlL3NlcnZpY2UvYWxlcnQuc2VydmljZSc7XHJcbmltcG9ydCB7IExvY2FsU2VydmljZSB9IGZyb20gJy4uL0Bjb3JlL3NlcnZpY2UvbG9jYWwuc2VydmljZSc7XHJcbmltcG9ydCB7IENvbXBvbmVudFN0YXRlIH0gZnJvbSAnLi4vQHNoYXJlZC9tYXN0ZXItdmlldy1zdGF0ZS9tYXN0ZXItdmlldy5zdGF0ZSc7XHJcbmltcG9ydCB7IHNlbGVjdEFsbEdyaWRzdGVySXRlbXMgfSBmcm9tICcuLi9Ac2hhcmVkL21hc3Rlci12aWV3LXN0YXRlL21hc3Rlci12aWV3LnNlbGVjdG9ycyc7XHJcbmltcG9ydCB7IGNsZWFyQ29tcG9uZW50cywgc2V0Q29tcG9uZW50cyB9IGZyb20gJy4uL0BzaGFyZWQvbWFzdGVyLXZpZXctc3RhdGUvbWFzdGVyLXZpZXcuYWN0aW9ucyc7XHJcbmltcG9ydCB7IER5bmFtaWNQYWdlQ29tcG9uZW50IH0gZnJvbSAnLi4vZHluYW1pYy10YWItcGFnZS9keW5hbWljLXBhZ2UvZHluYW1pYy1wYWdlLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IER5bmFtaWNTZWFyY2hDbGVhbnVwQ29tcG9uZW50IH0gZnJvbSAnLi4vZHluYW1pYy1zZWFyY2hjbGVhbnVwL2R5bmFtaWMtc2VhcmNoY2xlYW51cC5jb21wb25lbnQnO1xyXG4vLyBpbXBvcnQgeyBEeW5hbWljUGFnZU1vZGlmeUJ5cGFnZWlkQ29tcG9uZW50IH0gZnJvbSAnLi4vZHluYW1pYy10YWItcGFnZS9keW5hbWljLXBhZ2UtbW9kaWZ5LWJ5cGFnZWlkL2R5bmFtaWMtcGFnZS1tb2RpZnktYnlwYWdlaWQuY29tcG9uZW50JztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnYXBwLWNvbXBvc2l0ZS1wYWdlJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vY29tcG9zaXRlLXBhZ2UuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL2NvbXBvc2l0ZS1wYWdlLmNvbXBvbmVudC5zY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIENvbXBvc2l0ZVBhZ2VDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XHJcbiAgQ29tcG9zaXRlUGFnZVdpZGdldCQ6IE9ic2VydmFibGU8Q29tcG9uZW50U3RhdGVbXT47XHJcbiAgQElucHV0KCkgY29tcG9zaXRlUGFnZUlkO1xyXG4gIGlkIDogYW55O1xyXG4gIGFsZXJ0U2VydmljZTogQWxlcnRTZXJ2aWNlO1xyXG4gIHN0b3JhZ2U6IExvY2FsU2VydmljZTtcclxuICBlZGl0TW9kZTogYm9vbGVhbiA9IHRydWU7XHJcbiAgYWN0aXZlSW5kZXhlczogbnVtYmVyW10gPSBbXTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICBwcml2YXRlIHJvdXRlOiBBY3RpdmF0ZWRSb3V0ZSxcclxuICAgIHByaXZhdGUgZHluYW1pY1RhYlBhZ2VTZXJ2aWNlOiBEeW5hbWljVGFiUGFnZVNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHN0b3JlOiBTdG9yZTxBcHBTdGF0ZT5cclxuICApIHtcclxuICAgIHRoaXMuYWxlcnRTZXJ2aWNlID0gaW5qZWN0b3IuZ2V0PEFsZXJ0U2VydmljZT4oQWxlcnRTZXJ2aWNlKTtcclxuICAgIHRoaXMuc3RvcmFnZSA9IGluamVjdG9yLmdldDxMb2NhbFNlcnZpY2U+KExvY2FsU2VydmljZSk7XHJcbiAgICB0aGlzLkNvbXBvc2l0ZVBhZ2VXaWRnZXQkID0gdGhpcy5zdG9yZS5zZWxlY3Qoc2VsZWN0QWxsR3JpZHN0ZXJJdGVtcyk7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMuY29tcG9zaXRlUGFnZUlkID0gdGhpcy5yb3V0ZS5zbmFwc2hvdC5wYXJhbU1hcC5nZXQoJ2NvbXBvc2l0ZVBhZ2VJZCcpO1xyXG4gICAgdGhpcy5pZCA9IHRoaXMucm91dGUuc25hcHNob3QucGFyYW1NYXAuZ2V0KCdpZCcpO1xyXG5cclxuICAgIGlmKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5pbmNsdWRlcygnY29tcG9zaXRlLXBhZ2UvdmlldycpKXtcclxuICAgICAgdGhpcy5lZGl0TW9kZSA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgdGhpcy5nZXREeW5hbWljUGFnZSh0aGlzLmNvbXBvc2l0ZVBhZ2VJZCk7XHJcbiAgfVxyXG5cclxuICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLnJvdXRlLnBhcmFtTWFwLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgIHRoaXMuY29tcG9zaXRlUGFnZUlkID0gdGhpcy5yb3V0ZS5zbmFwc2hvdC5wYXJhbU1hcC5nZXQoJ2NvbXBvc2l0ZVBhZ2VJZCcpO1xyXG4gICAgICB0aGlzLmlkID0gdGhpcy5yb3V0ZS5zbmFwc2hvdC5wYXJhbU1hcC5nZXQoJ2lkJyk7XHJcbiAgICAgIHRoaXMuZ2V0RHluYW1pY1BhZ2UodGhpcy5jb21wb3NpdGVQYWdlSWQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXREeW5hbWljUGFnZShjb21wb3NpdGVQYWdlSWQpIHtcclxuICAgIHRoaXMuZHluYW1pY1RhYlBhZ2VTZXJ2aWNlLmdldER5bmFtaWNQYWdlKGNvbXBvc2l0ZVBhZ2VJZCkuc3Vic2NyaWJlKHZhbHVlID0+IHtcclxuICAgICAgY29uc3QgYWN0aXZldmVyc2lvbmlkID0gdmFsdWVbJ2RhdGEnXVswXS5hY3RpdmV2ZXJzaW9uaWQ7XHJcbiAgICAgIHRoaXMuZHluYW1pY1RhYlBhZ2VTZXJ2aWNlLmdldEFjdGl2ZVBhZ2UoYWN0aXZldmVyc2lvbmlkLCB0aGlzLmVkaXRNb2RlKS5zdWJzY3JpYmUocmVzdSA9PiB7XHJcbiAgICAgICAgaWYgKHJlc3UpIHtcclxuICAgICAgICAgIGNvbnN0IGNvbXBvc2l0ZVBhZ2Vjb25maWcgPSB0eXBlb2YgcmVzdVsnZGF0YSddLm1hc3RlcnZpZXdjb25maWcgPT09ICdzdHJpbmcnXHJcbiAgICAgICAgICAgID8gSlNPTi5wYXJzZShyZXN1WydkYXRhJ10ubWFzdGVydmlld2NvbmZpZylcclxuICAgICAgICAgICAgOiByZXN1WydkYXRhJ10ubWFzdGVydmlld2NvbmZpZztcclxuXHJcbiAgICAgICAgICBpZiAoY29tcG9zaXRlUGFnZWNvbmZpZykge1xyXG4gICAgICAgICAgICBjb21wb3NpdGVQYWdlY29uZmlnLmZvckVhY2goKHgsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgICAgeC5sb2FkZWRGcm9tQ29tcG9zaXRlUGFnZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgeC5pbnB1dCA9IHsgLi4ueC5pbnB1dCwgY29tcG9uZW50SWQ6IHguaWQsIGlkIDogdGhpcy5pZH07XHJcbiAgICAgICAgICAgICAgaWYgKHguY29tcG9uZW50TmFtZSA9PT0gJ2R5bmFtaWNwYWdlLWNvbW1vbicpIHtcclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHguY29tcG9uZW50ID0gRHluYW1pY1NlYXJjaENsZWFudXBDb21wb25lbnQ7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIGlmICh4LmNvbXBvbmVudE5hbWUgPT09ICdkeW5hbWljcGFnZS1zZWEnKSB7XHJcbiAgICAgICAgICAgICAgICB4LmNvbXBvbmVudCA9IER5bmFtaWNTZWFyY2hDbGVhbnVwQ29tcG9uZW50O1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgaWYgKHg/LnNldHRpbmdzPy5kZWZhdWx0U3RhdGUgPT0gJ0VYUCcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlSW5kZXhlcy5wdXNoKGluZGV4KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnN0b3JlLmRpc3BhdGNoKHNldENvbXBvbmVudHMoeyBjb21wb25lbnRzOiBjb21wb3NpdGVQYWdlY29uZmlnIH0pKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIGVycm9yID0+IHtcclxuICAgICAgdGhpcy5hbGVydFNlcnZpY2UuZXJyb3IoJ1NvbWV0aGluZyB3ZW50IHdyb25nJyk7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgIHRoaXMuc3RvcmUuZGlzcGF0Y2goY2xlYXJDb21wb25lbnRzKCkpO1xyXG4gIH1cclxufVxyXG4iLCJcclxuPGRpdiBjbGFzcz1cImZsb2F0LWNvbnRhaW5lclwiPlxyXG4gIDxkaXYgY2xhc3M9XCJmbG9hdC1jaGlsZC1yaWdodFwiPlxyXG4gICAgPGRpdiBjbGFzcz1cImRhc2hib2FyZC1pbm5lciBtdC0wXCI+XHJcbiAgICAgIDxkaXYgY2xhc3M9XCJmbG9hdC1jaGlsZC1yaWdodFwiPlxyXG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nRm9yPVwibGV0IGl0ZW0gb2YgQ29tcG9zaXRlUGFnZVdpZGdldCQgfCBhc3luYzsgbGV0IGkgPSBpbmRleFwiPlxyXG4gICAgICAgICAgPGRpdiBbbmdTd2l0Y2hdPVwiaXRlbT8uc2V0dGluZ3M/LmRlZmF1bHRTdGF0ZVwiPlxyXG4gICAgICAgICAgICA8cC1hY2NvcmRpb24gW211bHRpcGxlXT1cInRydWVcIiAqbmdTd2l0Y2hDYXNlPVwiJ0VYUCdcIiBbYWN0aXZlSW5kZXhdPVwiWzBdXCI+XHJcbiAgICAgICAgICAgICAgPHAtYWNjb3JkaW9uVGFiIGhlYWRlcj1cInt7aXRlbS5zZXR0aW5ncz8udGl0bGUgfHwgaXRlbS5uYW1lfX1cIj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjbGVhcmZpeCBncmlkc3Rlci1pdGVtLWdyb3VwIGNhcmRcIj5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImdyaWRzdGVyLWl0ZW0tY29udGVudCBjYXJkLWJvZHlcIj5cclxuICAgICAgICAgICAgICAgICAgICA8bmRjLWR5bmFtaWMgW25kY0R5bmFtaWNDb21wb25lbnRdPVwiaXRlbS5jb21wb25lbnRcIiBbbmRjRHluYW1pY0lucHV0c109XCJpdGVtLmlucHV0XCI+PC9uZGMtZHluYW1pYz5cclxuICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICA8L3AtYWNjb3JkaW9uVGFiPlxyXG4gICAgICAgICAgICA8L3AtYWNjb3JkaW9uPlxyXG4gICAgXHJcbiAgICAgICAgICAgIDxkaXYgKm5nU3dpdGNoQ2FzZT1cIidESVYnXCIgY2xhc3M9XCJjbGVhcmZpeCBncmlkc3Rlci1pdGVtLWdyb3VwIGNhcmQgbXQtNlwiPlxyXG4gICAgICAgICAgICAgIDxoNiBjbGFzcz1cImNhcmQtaGVhZGVyXCI+e3sgaXRlbS5zZXR0aW5ncz8udGl0bGUgfHwgaXRlbS5uYW1lIH19PC9oNj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZ3JpZHN0ZXItaXRlbS1jb250ZW50IGNhcmQtYm9keVwiPlxyXG4gICAgICAgICAgICAgICAgPG5kYy1keW5hbWljIFtuZGNEeW5hbWljQ29tcG9uZW50XT1cIml0ZW0uY29tcG9uZW50XCIgW25kY0R5bmFtaWNJbnB1dHNdPVwiaXRlbS5pbnB1dFwiPjwvbmRjLWR5bmFtaWM+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgXHJcbiAgICAgICAgICAgIDxwLWFjY29yZGlvbiBbbXVsdGlwbGVdPVwidHJ1ZVwiICpuZ1N3aXRjaERlZmF1bHQ+XHJcbiAgICAgICAgICAgICAgPHAtYWNjb3JkaW9uVGFiIGhlYWRlcj1cInt7aXRlbS5zZXR0aW5ncz8udGl0bGUgfHwgaXRlbS5uYW1lfX1cIj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjbGVhcmZpeCBncmlkc3Rlci1pdGVtLWdyb3VwIGNhcmRcIj5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImdyaWRzdGVyLWl0ZW0tY29udGVudCBjYXJkLWJvZHlcIj5cclxuICAgICAgICAgICAgICAgICAgICA8bmRjLWR5bmFtaWMgW25kY0R5bmFtaWNDb21wb25lbnRdPVwiaXRlbS5jb21wb25lbnRcIiBbbmRjRHluYW1pY0lucHV0c109XCJpdGVtLmlucHV0XCI+PC9uZGMtZHluYW1pYz5cclxuICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICA8L3AtYWNjb3JkaW9uVGFiPlxyXG4gICAgICAgICAgICA8L3AtYWNjb3JkaW9uPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9uZy1jb250YWluZXI+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgPC9kaXY+XHJcbjwvZGl2PiJdfQ==